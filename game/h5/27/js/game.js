!function(){window.onload=function(){i.setup()};var t=null,i={canvas:document.getElementById("canvas"),setup:function(){this.canvas.getContext&&(t=this.canvas.getContext("2d"),this.width=this.canvas.width,this.height=this.canvas.height,s.welcome(),this.canvas.addEventListener("click",this.runGame,!1),o.init())},animate:function(){i.play=requestAnimFrame(i.animate),i.draw()},init:function(){h.init(),e.init(),n.init(),a.init(),r.init()},draw:function(){t.clearRect(0,0,this.width,this.height),h.draw(),n.draw(),r.draw(),e.draw(),a.draw()},levelUp:function(){e.lv+=1,n.init(),a.init(),r.init()},levelLimit:function(t){return t<=10?t:10},runGame:function(){i.canvas.removeEventListener("click",i.runGame,!1),i.init(),i.animate()},restartGame:function(){i.canvas.removeEventListener("click",i.restartGame,!1),i.init()}},e={init:function(){this.lv=1,this.score=0},draw:function(){t.font="12px helvetica, arial",t.fillStyle="white",t.textAlign="left",t.fillText("Score: "+this.score,5,i.height-5),t.textAlign="right",t.fillText("Lv: "+this.lv,i.width-5,i.height-5)}},s={welcome:function(){this.text="****",this.textSub="www.sevenliao.com",this.textColor="white",this.create()},create:function(){t.fillStyle="black",t.fillRect(0,0,i.width,i.height),t.fillStyle=this.textColor,t.textAlign="center",t.font="40px helvetica, arial",t.fillText(this.text,i.width/2,i.height/2),t.fillStyle="#999999",t.font="20px helvetica, arial",t.fillText(this.textSub,i.width/2,i.height/2+30)},gameover:function(){this.text="Game Over",this.textSub="Click To Retry",this.textColor="red",this.create()}},h={init:function(){this.ready=!1,this.img=new Image,this.img.src="images/background.jpg",this.img.onload=function(){h.ready=!0}},draw:function(){this.ready&&t.drawImage(this.img,0,0)}},n={gap:4,col:5,w:188,h:30,r:15,init:function(){this.row=2+i.levelLimit(e.lv),this.total=0,this.count=[this.row];for(var t=this.row;t--;)this.count[t]=[this.col]},draw:function(){var e,s;for(e=this.row;e--;)for(s=this.col;s--;)if(!1!==this.count[e][s]){if(a.x>=this.x(s)&&a.x<=this.x(s)+this.w&&a.y>=this.y(e)&&a.y<=this.y(e)+this.h){this.collide(e,s);continue}t.fillStyle=this.gradient(e),t.beginPath(),t.moveTo(this.x(s)+15,this.y(e)),t.lineTo(this.x(s)+188-15,this.y(e)),t.arcTo(this.x(s)+188,this.y(e),this.x(s)+188,this.y(e)+15,this.r),t.arcTo(this.x(s)+188,this.y(e)+30,this.x(s),this.y(e)+30,this.r),t.lineTo(this.x(s)+15,this.y(e)+30),t.arcTo(this.x(s),this.y(e)+30,this.x(s),this.y(e),this.r),t.arcTo(this.x(s),this.y(e),this.x(s)+188,this.y(e),this.r),t.closePath(),t.fill()}this.total===this.row*this.col&&i.levelUp()},collide:function(t,i){e.score+=1,this.total+=1,this.count[t][i]=!1,a.sy=-a.sy},x:function(t){return t*this.w+t*this.gap},y:function(t){return t*this.h+t*this.gap},gradient:function(t){for(;t>3;)t-=4;switch(t){case 0:return this.gradientPurple?this.gradientPurple:this.gradientPurple=this.makeGradient(t,"#bd06f9","#9604c7");case 1:return this.gradientRed?this.gradientRed:this.gradientRed=this.makeGradient(t,"#F9064A","#c7043b");case 2:return this.gradientGreen?this.gradientGreen:this.gradientGreen=this.makeGradient(t,"#05fa15","#04c711");case 3:return this.gradientOrange?this.gradientOrange:this.gradientOrange=this.makeGradient(t,"#faa105","#c77f04")}},makeGradient:function(i,e,s){var h=this.y(i),n=t.createLinearGradient(0,h,0,h+this.h);return n.addColorStop(0,e),n.addColorStop(1,s),n}},a={r:15,init:function(){this.x=480,this.y=480,this.sx=1+.4*e.lv,this.sy=6+.8*e.lv},draw:function(){this.edges(),this.collide(),this.move(),t.beginPath(),t.arc(this.x,this.y,this.r,0,2*Math.PI),t.closePath(),t.fillStyle="#eee",t.fill()},edges:function(){if(this.y<1)this.y=1,this.sy=-this.sy;else if(this.y>i.height)return this.sy=this.sx=0,this.y=this.x=1e3,s.gameover(),void canvas.addEventListener("click",i.restartGame,!1);this.x<1?(this.x=1,this.sx=-this.sx):this.x>i.width&&(this.x=i.width-1,this.sx=-this.sx)},collide:function(){this.x>=r.x&&this.x<=r.x+r.w&&this.y>=r.y&&this.y<=r.y+r.h&&(this.sx=(this.x-(r.x+r.w/2))/r.w*14,this.sy=-this.sy)},move:function(){this.x+=this.sx,this.y+=this.sy}},r={w:180,h:25,r:12,init:function(){this.x=390,this.y=480,this.speed=8},draw:function(){this.move(),t.beginPath(),t.moveTo(this.x,this.y),t.arcTo(this.x+this.w,this.y,this.x+this.w,this.y+this.r,this.r),t.lineTo(this.x+this.w,this.y+this.h-this.r),t.arcTo(this.x+this.w,this.y+this.h,this.x+this.w-this.r,this.y+this.h,this.r),t.lineTo(this.x+this.r,this.y+this.h),t.arcTo(this.x,this.y+this.h,this.x,this.y+this.h-this.r,this.r),t.lineTo(this.x,this.y+this.r),t.arcTo(this.x,this.y,this.x+this.r,this.y,this.r),t.closePath(),t.fillStyle=this.gradient(),t.fill()},gradient:function(){return this.gradientCache?this.gradientCache:(this.gradientCache=t.createLinearGradient(this.x,this.y,this.x,this.y+20),this.gradientCache.addColorStop(0,"#eee"),this.gradientCache.addColorStop(1,"#999"),this.gradientCache)},move:function(){o.left&&this.x<i.width-this.w/2?this.x+=this.speed:o.right&&this.x>-this.w/2&&(this.x+=-this.speed)}},o={init:function(){window.addEventListener("keydown",this.keyDown,!0),window.addEventListener("keyup",this.keyUp,!0),window.addEventListener("mousemove",this.movePaddle,!0),i.canvas.addEventListener("touchstart",this.movePaddle,!1),i.canvas.addEventListener("touchmove",this.movePaddle,!1),i.canvas.addEventListener("touchmove",this.stopTouchScroll,!1)},keyDown:function(t){switch(t.keyCode){case 39:o.left=!0;break;case 37:o.right=!0}},keyUp:function(t){switch(t.keyCode){case 39:o.left=!1;break;case 37:o.right=!1}},movePaddle:function(t){var e=t.pageX,s=i.canvas.offsetLeft,h=r.w/2;if(e>s&&e<s+i.width){var n=e-s;n-=h,r.x=n}},stopTouchScroll:function(t){t.preventDefault()}}}(),window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)};